<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}My Website{% endblock %}</title>
    <style>
        /* body {
            margin-left: 250px; 
            font-family: Arial, sans-serif;
        } */
        html {
            height: 100%; /* 页面高度覆盖整个视口 */
        }
        /* body {
            font-family: Arial, sans-serif;
            background-color: #c9ecfa;
            margin: 0;
            padding: 0;
            height: 100%; 

        } */
        body {
            transition: background-image 1s ease-in-out;
            min-height: 100vh;
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            margin: 0;
            /* padding: 0;
            font-family: Arial, sans-serif;
            font-size: 16px; 
            background: linear-gradient(to bottom,#01034b, #c9ecfa);
            line-height: 1.6; */
        }

        .container {
            max-width: 1200px; /* 设置最大宽度 */
            margin: 0 auto; /* 水平居中 */
            padding: 10px;
            box-sizing: border-box;
        }

        img {
            max-width: 100%; /* 图片根据容器宽度自适应 */
            height: auto;
        }
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 250px; /* 默认宽度 */
            height: 100vh;
            background: linear-gradient(to bottom, #f4f4f4, #eaeaea);
            border: none;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            overflow-y: auto;
            transition: transform 0.3s ease; /* 滑动动画 */
            transform: translateX(0); /* 默认展开 */
            z-index: 10;
        }

        .sidebar.collapsed {
            transform: translateX(-250px); /* 收起时滑动出屏幕 */
        }
        .sidebar-button{
            display: block;
            padding: 12px 20px;
            margin: 5px 10px;
            text-decoration: none;
            font-size: 1em;
            color: #333;
            border-radius: 5px;
            transition: background 0.3s ease, color 0.3s ease;
        }
        .sidebar-button :hover{
            background-color: #007bff;
            color: #fff;
        }

        .toggle-button {
            position: fixed;
            top: 50%; /* 垂直居中 */
            transform: translateY(-50%);
            width: 15px; 
            height: 35px;
            background-color: #eaeaea;
            color: black;
            text-align: left;
            font-size: 14px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 0px 10px 10px 0px; /* 圆形按钮 */
            cursor: pointer;

            transition: all 0.3s ease; /* 动画效果 */
            z-index: 11;
        }


        /* .toggle-button:hover {
            background-color: #c9ecfa;
        } */

        /* 按钮被点击时效果 */
        .toggle-button:active {
            transform: translateY(-50%) scale(0.95); /* 轻微缩小，增加反馈感 */
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 200px;
            }

            .sidebar.collapsed {
                transform: translateX(-200px);
            }

            .toggle-button {
                width: 30px;
                height: 30px;
                font-size: 0.8em;
            }
        }

        /* 移动设备 */
        @media screen and (max-width: 768px) {
            .sidebar {
                position: fixed;
                width: 100%;
                height: auto;
            }
            .content {
                margin-left: 0;
            }
        }

        /* 极小屏幕（如手机） */
        @media (max-width: 480px) {
            body {
                font-size: 14px; /* 缩小字体大小 */
            }

            .content {
                padding: 5px;
            }
        }
        .container {
            display: flex;
            flex-wrap: wrap; /* 容器内的项目根据屏幕大小自动换行 */
            gap: 10px;
        }

        .item {
            flex: 1 1 calc(33.33% - 10px); /* 每项占一行的三分之一，减去间距 */
            background-color: #fff;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            box-sizing: border-box;
        }

        /* 调整到两列 */
        /* @media (max-width: 768px) {
            .item {
                flex: 1 1 calc(50% - 10px);
            }
        } */

        /* 调整到一列 */
        /* @media (max-width: 480px) {
            .item {
                flex: 1 1 100%;
            }
        } */
        .container {
            display: grid;
            grid-template-columns: repeat(3, 1fr); /* 默认 3 列布局 */
            gap: 10px;
        }

        .item {
            background-color: #fff;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* 调整到两列 */
        /* @media (max-width: 768px) {
            .container {
                grid-template-columns: repeat(2, 1fr);
            }
        } */

        /* 调整到一列 */
        /* @media (max-width: 480px) {
            .container {
                grid-template-columns: 1fr;
            }
        } */


        .profile {
            text-align: center;
            padding: 20px 10px;
            background-color: #fff;
            border-bottom: 1px solid #ddd; /* 分隔 profile 和 menu */
        }

        .profile img {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            margin-bottom: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* 图片阴影 */
        }

        .profile h3 {
            margin: 5px 0;
            font-size: 1.2em;
            color: #333;
            font-weight: bold;
        }

        .profile p {
            margin: 0;
            font-size: 0.9em;
            color: #777;
        }

        .menu {
            flex: 1;
            padding: 20px 0;
        }

        .menu a {
            display: block;
            padding: 12px 20px;
            margin: 5px 10px;
            text-decoration: none;
            font-size: 1em;
            color: #333;
            background-color: #f4f4f4;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .menu a:hover {
            background-color: #007bff;
            color: #fff;
            transform: scale(1.05); /* 放大动画 */
        }

        .menu .submenu a {
            margin-left: 30px; /* 缩进子菜单 */
            font-size: 0.9em;
            color: #555;
            
        }

        .menu .submenu a:hover {
            background-color: red;
            color: #fff;
        }

        .admin-section {
            padding: 10px;
            border-top: 1px solid #ddd; /* 分隔菜单和底部区域 */
            text-align: center;
        }



        .admin-section a {
            display: block;
            padding: 12px 20px;
            margin: 5px 10px;
            text-decoration: none;
            font-size: 1em;
            color: #333;
            background-color: #f4f4f4;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
            border-radius: 5px;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .admin-section a:hover {
            background-color: #007bff;
            color: #fff;
            transform: scale(1.05); /* 放大动画 */
        }

        h1 {
            font-size: 2em;
            margin-bottom: 20px;
            color: #333;
        }

        h2, h3 {
            margin-top: 15px;
            color: #555;
        }

        p {
            font-size: 1.2em;
            line-height: 1.6;
            margin-bottom: 15px;
        }
        h1 {
            font-size: clamp(1.5rem, 2.5vw, 3rem); /* 最小 1.5rem，最大 3rem，根据视口宽度调整 */
        }

        p {
            font-size: clamp(0.9rem, 1.5vw, 1.2rem);
        }

        ul {
            padding-left: 20px;
            margin-bottom: 20px;
        }

        strong {
            color: #333;
        }

        a {
            color: blue;
            text-decoration: underline;
        }

        a:hover {
            color: darkblue;
        }
        .image-slider {
            width: 100%; /* 图片轮换器与 content 部分宽度一致 */
            
            max-width: 800px;
            height: 400px;
            position: relative;
            overflow: hidden;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .image-slider img {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .image-slider img.active {
            opacity: 1;
        }

        .slider-buttons {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
        }

        .slider-buttons button {
            width: 15px;
            height: 15px;
            border: none;
            border-radius: 50%;
            background-color: white;
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.3);
            cursor: pointer;
        }

        .slider-buttons button.active {
            background-color: #007bff;
        }
        /* .top-left-button {
            position: absolute;
            top: 10px;
            left: 10px;
        }        
        .return-home {
            display: inline-block;
            top: 0;
            left: 0;
            margin-top: 15px;
            padding: 10px 20px;
            background-color: #f4f4f4;
            color: #333;
            text-decoration: none;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        .return-home:hover {
            background-color: #ddd;
        } */
        .content {
            margin-left: 250px; /* 为侧边栏留出空间 */
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* 添加阴影 */
            max-width: 900px;
            height: 100vh; /* 高度覆盖整个视口 */
            overflow-y: auto; /* 如果内容超出视口，则允许滚动 */
            margin: 0 auto; /* 居中显示 */
            box-sizing: border-box;
        }

        .content h1 {
            font-size: 2em;
            margin-bottom: 10px;
            color: #333;
        }

        .content p {
            font-size: 1em;
            line-height: 1.6;
            color: #555;
            margin-bottom: 15px;
        }
        #comments-section {
            margin-top: 20px;
            padding: 20px;
            border-top: 1px solid #ddd;
        }

        #comments-section h2 {
            margin-bottom: 15px;
        }

        #comments-list .comment-item {
            margin-bottom: 10px;
            padding: 10px;
            border-radius: 5px;
            background-color: #f0f8ff; /* 浅蓝色背景 */
            border: 1px solid #87cefa; /* 边框颜色与主题一致 */
        }

        #add-comment textarea {
            width: 100%;
            margin-bottom: 10px;
            padding: 10px;
            font-size: 14px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        #add-comment button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #add-comment button:hover {
            background-color: #0056b3;
        }
        .comment-item {
            position: relative;
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            background-color: #f0f8ff; /* 浅蓝色背景 */
            border: 1px solid #87cefa; /* 边框颜色与主题一致 */
            font-size: 0.9em;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .comment-actions {
            position: absolute;
            bottom: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
        }

        .comment-item button {
            padding: 3px 8px;
            font-size: 0.75em;
            color: #fff;
            background-color: #007bff;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
        }

        .comment-item button:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }

        .comment-item button.delete-button {
            background-color: #dc3545;
        }

        .comment-item button.delete-button:hover {
            background-color: #a71d2a;
        }

        @media screen and (max-width: 600px) {
            .comment-actions {
                bottom: 5px;
                right: 5px;
                flex-direction: column; /* 按钮纵向排列 */
            }

            .comment-item button {
                margin-left: 0; /* 取消横向间距 */
                margin-top: 5px; /* 添加纵向间距 */
            }
        }


        .upload-avatar-button {
            display: block;
            margin: 15px 20px; /* 与其他菜单对齐 */
            padding: 10px;
            text-align: center;
            text-decoration: none;
            color: #333;
            background-color: #f4f4f4;
            border-radius: 5px;
            font-weight: bold;
            border: 1px solid #ccc;
            cursor: pointer;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .upload-avatar-button:hover {
            background-color: #007bff;
            color: white;
            transform: scale(1.05);
        }

        #projects-list {
            font-size: 1.5em;
            display: flex;
            flex-direction: column; /* 列布局 */
            align-items: center; /* 项目居中对齐 */
            gap: 10px; /* 项目间距 */
            padding: 20px;
            height: 100%; /* 填满内容区域 */
            overflow-y: auto; /* 如果项目过多，允许滚动 */
            box-sizing: border-box;
        }

        .project-button {
            display: block;
            width: 100%; /* 按钮宽度与容器一致 */
            max-width: 400px; /* 设置最大宽度 */
            padding: 10px; /* 按钮内边距 */
            margin: 5px auto; /* 居中对齐 */
            font-size: 0.9em; /* 字体大小 */
            text-align: center;
            color: #333; /* 字体颜色 */
            background-color: #f4f4f4; /* 按钮背景色 */
            border: none; /* 去除边框 */
            border-radius: 5px; /* 圆角 */
            cursor: pointer; /* 鼠标悬停时显示手型 */
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1); /* 内部阴影 */
            transition: background 0.3s ease, transform 0.2s ease, color 0.3s ease; /* 动态效果 */
        }

        .project-button:hover {
            background-color: #007bff; /* 悬停时按钮背景色 */
            color: #fff; /* 悬停时按钮文字颜色 */
            transform: scale(1.05); /* 悬停时轻微放大 */
        }

        .project-button:active {
            background-color: #0056b3; /* 点击时按钮背景色更深 */
            transform: scale(0.95); /* 点击时轻微缩小 */
        }

        .back-button {
            margin-top: 20px;
            padding: 10px 15px;
            background-color: #6c757d;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        .back-button:hover {
            background-color: #5a6268;
        }
        .extra-section {
            transition: background-color 0.5s ease, border-color 0.5s ease; /* 添加背景和边框颜色的过渡 */
            margin-top: 20px;
            padding: 20px;
            border: 2px solid #87cefa; /* 初始边框颜色 */
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* .extra-section h2 {
            font-size: 1.8rem;
            color: #4682b4; 
            margin-bottom: 10px;
        } */

        .extra-section p {
            font-size: 1.2rem;
            color: #333;
            line-height: 1.5;
        }
        .extra-section {
            margin-top: 20px;
            padding: 20px;
            background-color: #f0f8ff;
            border: 1px solid #87cefa;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        /* 媒体内容区域 */
        .media-section, .video-section {
            margin-top: 20px;
        }

        .media-section h3, .video-section h3 {
            font-size: 1.5rem;
            color: #4682b4;
            margin-bottom: 10px;
        }

        /* 图片样式 */
        .media-image {
            width: 100%;
            max-width: 300px;
            margin: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .media-image.zoomed {
            transform: scale(2);  /* 放大倍数，可以根据需求调整 */
            cursor: zoom-out;  /* 双击时，指针变为缩小的图标 */
        }

        .media-image:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.2);
        }

        /* 视频样式 */
        .media-video {
            width: 100%;
            max-width: 500px;
            margin-top: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        /* .back-button {
            position: fixed;
            bottom: 20px; 
            right: 20px; 
            width: 50px; 
            height: 50px; 
            background-color: #4682b4; 
            color: white;
            font-size: 18px;
            font-weight: bold;
            border: none;
            border-radius: 50%; 
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.3s ease;
            z-index: 1000; 
        }

        .back-button:hover {
            background-color: #315f7a; 
            transform: scale(1.1); 
        }

        .back-button:active {
            transform: scale(0.9); 
        } */
        
        .contact-link {
            text-decoration: none;
            color: #007bff;
            font-weight: bold;
            transition: color 0.3s ease;
        }

        .contact-link:hover {
            color: #0056b3;
            text-decoration: underline;
        }
        .page-title {
            text-align: center;
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px 0 20px;
            color: #333; /* 保持主题色彩 */
        }
        .search-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
            margin-bottom: 20px;
            background-color: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .search-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1em;
            margin-right: 10px;
        }

        .search-button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background-color 0.3s ease;
        }

        .search-button:hover {
            background-color: #0056b3;
        }
        .pagination {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .pagination button {
            margin: 0 5px;
            padding: 5px 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .pagination button.active {
            background-color: #0056b3;
        }

        .pagination button:hover {
            background-color: #0056b3;
        }
        /* .dashboard-info {
            margin-bottom: 20px;
            background-color: #f4f4f4;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .dashboard-sections {
            display: flex;
            gap: 20px;
        }

        .section {
            flex: 1;
            background-color: #f0f8ff;
            border: 1px solid #87cefa;
            border-radius: 5px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .section h3 {
            margin-bottom: 10px;
            color: #007bff;
        }

        ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        ul li {
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        ul li:last-child {
            border-bottom: none;
        }

        a {
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        a:hover {
            background-color: #0056b3;
        } */

        
    </style>
    {% load static %}
    <script src="{% static 'js/marked.min.js' %}"></script>
</head>
<body>
    
    <div class="sidebar" id ="sidebar">
        <!-- <a href="{% url 'home' %}" class="return-home">Back</a> -->
        <div class="profile">
            {% if user.is_authenticated %}
            <img src="{% if user.is_authenticated and user.profile.avatar %}{{ user.profile.avatar.url }}{% else %}/static/img/default.jpg{% endif %}" 
            alt="Profile Photo" 
            style="width: 100px; height: 100px; border-radius: 50%;">
            
            <h3>{{ user.username }}</h3>
            <hr>
            {% else %}
            <h3>Welcome</h3>
            {% endif %}
            <div class = "admin_section">
            {% if user.is_authenticated %}
 
            {% if user.is_superuser %}
                <a href="{% url 'admin_edit' %}">Admin Edit</a>
            {% endif %}
                <a href="{% url 'logout' %}">Logout</a>
            {% else %}
                <a href="{% url 'login' %}">Login</a>
                <a href="{% url 'register' %}">Register</a>
            {% endif %}
            </div>
            {% if user.is_authenticated %}
            <a href="{% url 'upload_avatar' %}" class="upload-avatar-button">Upload/Update Photo</a>
            {% endif %}
            
        </div>
        <div class="menu">
            
            <a href="#" onclick="loadContent('home')">Home Page</a>
            <!-- <a href="#" onclick="loadContent('dashboard')">Dashboard</a> -->
            <a href="#" onclick="loadContent('personal_detail')">Personal Detail</a>
            <a href="#" onclick="toggleSubMenu()">About Me</a>
            <div id="submenu" class="submenu" style="display: none;">
                <a href="#" onclick="loadContent('personal_experience')">Personal Experience</a>
                <a href="#" onclick="loadContent('hobbies')">Favorites</a>
            </div>
            <a href="#" onclick="loadContent('contact')">Contact Me</a>
        </div>
    </div>
    <button class="toggle-button" id="toggleButton"></button>
    
    <div class="content" id="content">
        {% block content %}
        <h1>Welcome to My Website</h1>
        <p>Click the menu items to explore more.</p>
        <p>This is previews page just for display please feel free to explore my website</p>
        <p><strong>You have the option to register or log in to get started, and for the most complete experience, I recommend registering an account of your own!<strong></p>
        <div class="extra-section">
        <div class="image-slider" id="imageSlider">
            <img src="/static/img/img1.jpg" class="active">
            <img src="/static/img/img2.jpg">
            <img src="/static/img/img3.jpg">
        </div>
        </div>
        {% endblock %}
    </div>

    
    

    <script>    
        const currentDate = new Date();
        const month = currentDate.getMonth();  // 0-11, 0代表1月，11代表12月

        // 判断当前季节，并设置对应的背景图片
        function setSeasonalBackground() {
            let backgroundImage;

            if (month >= 2 && month <= 4) {  // 春季 3月到5月
                backgroundImage = "url('/static/img/mc1.png')";
            } else if (month >= 5 && month <= 7) {  // 夏季 6月到8月
                backgroundImage = "url('/static/img/mc2.png')";
            } else if (month >= 8 && month <= 10) {  // 秋季 9月到11月
                backgroundImage = "url('/static/img/mc3.png')";
            } else {  // 冬季 12月到2月
                backgroundImage = "url('/static/img/mc4.png')";
            }

            // 设置背景图片
            document.body.style.backgroundImage = backgroundImage;
        }

        // 调用函数设置背景
        setSeasonalBackground();

        function getSeason(){
            if (month >= 2 && month <= 4) {
                return 'spring';  // 春季 (3, 4, 5 月)
            } else if (month >= 5 && month <= 7) {
                return 'summer';  // 夏季 (6, 7, 8 月)
            } else if (month >= 8 && month <= 10) {
                return 'autumn';  // 秋季 (9, 10, 11 月)
            } else {
                return 'winter';  // 冬季 (12, 1, 2 月)
            }
        }
        function setSeasonalStyle() {
            const season = getSeason();
            const section = document.querySelector('.extra-section');
            
            // 根据季节设置不同的边框和背景颜色
            switch (season) {
                case 'spring':
                    section.style.borderColor = '#006400';
                    section.style.backgroundColor = '#90EE90';
                    break;
                case 'summer':
                    section.style.borderColor = '#bdb76b';
                    section.style.backgroundColor = '#ffe4e1';
                    break;
                case 'autumn':
                    section.style.borderColor = '#bdb76b';
                    section.style.backgroundColor = '#fafad2';
                    break;
                case 'winter':
                    section.style.borderColor = '#4682b4';
                    section.style.backgroundColor = '#f0f8ff';
                    break;
                default:
                    break;
            }
        }
        document.addEventListener('DOMContentLoaded', setSeasonalStyle);

        let isAdmin = false;
        function loadContent(type) {
            
            fetch('/api/user_status/')
            .then(response => response.json())
            .then(data => {
                const adminContentDiv = document.getElementById('admin-content');
                
                if (data.is_admin) {
                    isAdmin = true;
                } else {
                    isAdmin=false;
                }
            })
            .catch(error => {
                console.error('获取用户信息失败:', error);
            });

            const contentDiv = document.getElementById('content');
            let apiUrl;

            if (type === 'personal_experience') {
                apiUrl = '/api/personal_experience/'; // 使用专用 API
            } else {
                apiUrl = `/api/${type}/`;
            }

            fetch(apiUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.json();
                })
                .then(data => {
                    contentDiv.innerHTML = ''; // 清空内容区域

                    if (type === 'personal_experience') {
                        // 动态加载项目列表
                        apiUrl = '/api/personal_experience/';
                        fetch(apiUrl)
                            .then(response => response.json())
                            .then(data => {
                                contentDiv.innerHTML = `
                                    <h1 class="page-title">Personal Experience</h1>
                                    <div class="search-container">
                                        <input type="text" id="searchInput" placeholder="Search projects..." class="search-input">
                                        <button id="searchButton" class="search-button">Search</button>
                                    </div>
                                    <div id="projects-list"></div>
                                `;

                                const projectsList = document.getElementById('projects-list');

                                // 默认加载所有项目
                                renderProjects(data.projects);

                                // 添加搜索功能
                                const searchInput = document.getElementById('searchInput');
                                const searchButton = document.getElementById('searchButton');

                                searchButton.addEventListener('click', () => {
                                    const query = searchInput.value.trim().toLowerCase();
                                    const filteredProjects = data.projects.filter(project =>
                                        project.name.toLowerCase().includes(query)
                                    );
                                    renderProjects(filteredProjects);
                                });
                            })
                    } else if (type === 'home'){
                        const markdownHTML = marked.parse(data.markdown);
                        
                        contentDiv.innerHTML += markdownHTML;

                        // 插入额外元素
                        const extraContent = `
                            <div class="extra-section">
                                <h2>About This Website</h2>
                                <p>Welcome to the homepage! This website is designed to showcase various features and dynamic content. Feel free to explore.</p>
                                
                                <!-- 图片内容 -->
                                <div class="media-section">
                                    <h3>Photo Gallery</h3>
                                    <img src="/static/img/img1.jpg" alt="Example Image 1" class="media-image">
                                    <img src="/static/img/img2.jpg" alt="Example Image 2" class="media-image">
                                </div>
                                
                                <!-- 视频内容 -->
                                <div class="video-section">
                                    <h3>Featured Video</h3>
                                    <video controls class="media-video">
                                        <source src="/static/videos/example.mp4" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                
                        `;
                        
                        contentDiv.innerHTML += extraContent;
                        // applyPresetColorsToExtraSection();
                        const image = document.getElementById('media-image');
                        if (image) {
                            image.addEventListener('dblclick', function () {
                                if (image.classList.contains('zoomed')) {
                                    image.classList.remove('zoomed');
                                } else {
                                    image.classList.add('zoomed');
                                }
                            });
                        }
                        
                    } else if (type === 'personal_detail') {
                        const markdownHTML = marked.parse(data.markdown);
                        contentDiv.innerHTML += markdownHTML;

                        // 插入额外元素
                        const extraContent = `
                            <div class="extra-section">
                                <h2>More About Me</h2>
                                <p>Here are some additional details about me that you might find interesting. Feel free to reach out if you'd like to learn more!</p>
                                
                                <!-- 媒体内容 -->
                                <div class="media-section">
                                    <h3>Hobbies</h3>
                                    <img src="/static/img/img1.jpg" alt="Hobby 1" class="media-image">
                                    <img src="/static/img/img2.jpg" alt="Hobby 2" class="media-image">
                                </div>
                                
                                <div class="video-section">
                                    <h3>My Introduction Video</h3>
                                    <video controls class="media-video">
                                        <source src="/static/videos/introduction.mp4" type="video/mp4">
                                        Your browser does not support the video tag.
                                    </video>
                                </div>
                            </div>
                        `;
                        
                        contentDiv.innerHTML +=extraContent;
                        // applyPresetColorsToExtraSection();
                        } else if (type === 'hobbies') {
                            const markdownHTML = marked.parse(data.markdown);
                            contentDiv.innerHTML += markdownHTML;

                            const extraContent = `
                                <div class="extra-section">
                                    <h2>My Favorites</h2>
                                    <p>Here are some of my favorite things that I would love to share with you. Explore the gallery below to know more!</p>
                                    <div class="media-section">
                                        <h3>Favorite Photos</h3>
                                        <img src="/static/img/favorite1.jpg" alt="Favorite Image 1" class="media-image">
                                        <img src="/static/img/favorite2.jpg" alt="Favorite Image 2" class="media-image">
                                        <img src="/static/img/favorite3.jpg" alt="Favorite Image 3" class="media-image">
                                        <img src="/static/img/favorite4.jpg" alt="Favorite Image 4" class="media-image">
                                    </div>
                                </div>
                            `;
                            contentDiv.innerHTML += extraContent;
                            // applyPresetColorsToExtraSection();
                            
                    }else if (type === 'contact') {
                        fetch('/api/contact/')
                        .then(response => response.json())
                        .then(data => {
                            const contentDiv = document.getElementById('content');
                            contentDiv.innerHTML = `
                                <h1>Contact Me</h1>
                                <p>
                                    Phone 1: <a href="tel:${data.phone1}" class="contact-link" id="phone1">${data.phone1}</a><br>
                                    Phone 2: <a href="tel:${data.phone2}" class="contact-link" id="phone2">${data.phone2}</a><br>
                                    Email: <a href="mailto:${data.email}" class="contact-link" id="email">${data.email}</a><br>
                                </p>
                                ${isAdmin ? '<button id="editContactButton" class="edit-button">Edit Contact</button>' : ''}
                                
                                
                            `;                           
                            // console.log(contentDiv.innerHTML);
                            const editButton = document.getElementById('editContactButton');
                            if (editButton) {
                                editButton.addEventListener('click', function () {
                                    enableEditMode(data);
                                });
                            } else {
                                console.warn('Edit button not rendered.');
                            }
                        })
                        .catch(error => console.error('Error loading contact:', error));
                    }
                
                else if (type === 'dashboard') {
                    fetch('/api/dashboard/')
                        .then(response => response.json())
                        .then(data => {
                            const contentDiv = document.getElementById('content');
                            contentDiv.innerHTML = `
                                <h1 class="page-title">Dashboard</h1>
                                <div class="dashboard-info">
                                    <h2>Welcome, ${data.username}</h2>
                                    <p>Email: ${data.email}</p>
                                </div>
                                <div class="dashboard-sections">
                                    <div class="section recent-comments">
                                        <h3>Recent Comments</h3>
                                        <ul id="recentCommentsList"></ul>
                                    </div>
                                    
                                    <div class="section actions">
                                        <h3>Quick Actions</h3>
                                        <a herf="/avatar_upload/">Edit Profile</a><br/>
                                        <button onclick="loadContent('upload_avatar')">Change Avatar</button><br/>
                                        <button onclick="loadContent('favorites')">View Favorites</button>
                                    </div>
                                </div>
                            `;

                            // Populate recent comments
                            const commentsList = document.getElementById('recentCommentsList');
                            if (data.recent_comments.length > 0) {
                                data.recent_comments.forEach(comment => {
                                    commentsList.innerHTML += `
                                        <li>
                                            <strong>${comment.project}</strong>: ${comment.text} <br/>
                                            
                                        </li>
                                    `;
                                });
                            } else {
                                commentsList.innerHTML = '<li>No recent comments.</li>';
                            }

                            // Populate rated projects
                            const ratedList = document.getElementById('ratedProjectsList');
                            if (data.rated_projects.length > 0) {
                                data.rated_projects.forEach(project => {
                                    ratedList.innerHTML += `
                                        <li>
                                            <strong>${project.project}</strong>: Rated ${project.score}/5
                                        </li>
                                    `;
                                });
                            } else {
                                ratedList.innerHTML = '<li>No rated projects.</li>';
                            }
                        })
                        .catch(error => console.error('Error loading dashboard:', error));
                }
            })
                .catch(error => console.error('Error:', error));
        }

        function renderProjects(projects) {
            const projectsList = document.getElementById('projects-list');
            projectsList.innerHTML = ''; // 清空项目列表

            if (projects.length === 0) {
                projectsList.innerHTML = '<p>No projects found.</p>';
                return;
            }

            projects.forEach(project => {
                const projectButton = document.createElement('button');
                projectButton.className = 'project-button';
                projectButton.textContent = project.name;
                projectButton.onclick = () => loadProjectDetails(project);
                projectsList.appendChild(projectButton);
            });
        }


        function loadProjectDetails(project) {
            const contentDiv = document.getElementById('content');
            const extraSection = document.getElementById('.extra-section')
            const apiUrlComments = `/api/comments/${encodeURIComponent(project.name)}/`;
            const apiUrlUserStatus = '/api/user_status/';
            contentDiv.innerHTML = `
                <button class="back-button" onclick="loadContent('personal_experience')">Back</button>
                <h1>${project.name}</h1>
                <p>${project.description}</p>
            `;
            if (project.gallery && project.gallery.length > 0) {
                const galleryHTML = `
                    <h2>Gallery</h2>
                    <div class="image-slider" id="imageSlider">
                        ${project.gallery.map(img => `<img src="${img}" alt="${project.name}" class="gallery-image">`).join('')}
                    </div>
                `;
                extraSection.innerHTML = galleryHTML;
            } else {
                extraSection.innerHTML = `<p>No images available for this project.</p>`;
            }

            // 添加画廊样式（放大功能可选）
            const galleryImages = document.querySelectorAll('.gallery-image');
            galleryImages.forEach(img => {
                img.addEventListener('click', () => {
                    if (img.classList.contains('zoomed')) {
                        img.classList.remove('zoomed');
                    } else {
                        galleryImages.forEach(img => img.classList.remove('zoomed'));
                        img.classList.add('zoomed');
                    }
                });
            });
            fetch(apiUrlUserStatus)
                        .then(response => response.json())
                        .then(userStatus => {
                            const isAuthenticated = userStatus.is_authenticated;
                            contentDiv.innerHTML += `
                                <div id="comments-section">
                                    <h2>Comments & Ratings</h2>
                                    <div id="comments-list">
                                        <!-- 评论列表将动态加载 -->
                                    </div>
                                    ${isAuthenticated ? `
                                        <div id="rating">
                                            <label for="rating">Rate this project:</label>
                                            <select id="ratingValue">
                                                <option value="5">5 - Excellent</option>
                                                <option value="4">4 - Very Good</option>
                                                <option value="3">3 - Good</option>
                                                <option value="2">2 - Fair</option>
                                                <option value="1">1 - Poor</option>
                                            </select>
                                        </div>
                                        <div id="add-comment">
                                            <label for="comment">Add a Comment:</label>
                                            <textarea id="commentText" rows="4" cols="50"></textarea>
                                            <button onclick="submitComment('${project.name}')">Submit</button>
                                        </div>
                                    ` : `
                                        <p>Please <a href="/login/">log in</a> to leave a comment.</p>
                                    `}
                                </div>
                            `;

                            // 加载评论列表
                            loadComments(project.name);
                        })
        }

        function loadComments(projectName, page = 1){
            const commentsDiv = document.getElementById('comments-list');
            const apiUrlComments = `/api/comments/${encodeURIComponent(projectName)}/?page=${page}&per_page=5`;
            const presetColors = [
                { backgroundColor: "#f0f8ff", borderColor: "#4682b4" }, // 浅蓝色 + 深蓝色
                // { backgroundColor: "#ffe4e1", borderColor: "#cd5c5c" }, // 淡粉色 + 红棕色
                // { backgroundColor: "#fafad2", borderColor: "#bdb76b" }, // 浅黄色 + 暗卡其色
                // { backgroundColor: "#d3d3d3", borderColor: "#a9a9a9" },// 浅灰色 + 暗灰色
                ];
            fetch(apiUrlComments)
                .then(response => response.json())
                .then(data => {
                    commentsDiv.innerHTML = '<h3>All Comments</h3>';
                    if (data.comments.length === 0) {
                        commentsDiv.innerHTML += '<p>No comments yet. Be the first to comment!</p>';
                    } else {
                        const currentUser = data.current_user;
                        // console.log(`currentUser: ${currentUser}`);
                        data.comments.forEach(comment => {
                            
                            // 随机选择一个颜色
                            // console.log(`currentUser: ${currentUser}`);
                            const randomColor = presetColors[Math.floor(Math.random() * presetColors.length)];
                            const commentItem = document.createElement('div');
                            commentItem.className = 'comment-item';
                            const { backgroundColor, borderColor } = getRandomColorFromPreset();
                            // commentItem.style.backgroundColor = backgroundColor;
                            // commentItem.style.borderColor = borderColor;// 设置背景颜色
                            let commentHTML = `
                                <p><strong>${comment.user}</strong> (${comment.rating}/5):</p>
                                <p>${comment.text}</p>
                            `;
                            if (currentUser === comment.user) {
                                commentHTML += `
                                    <button onclick="editComment('${projectName}', '${comment.id}')" class="edit-button">
                                        <i class="fas fa-edit"></i>Edit
                                    </button>

                                `;
                            }
                            if (isAdmin == true || currentUser === comment.user) {
                                commentHTML += `
                                    <button onclick="deleteComment('${projectName}', '${comment.id}')" class="delete-button">
                                        <i class="fas fa-trash"></i>Delete
                                    </button>
                                `;
                            } 
                            commentItem.innerHTML = commentHTML;
                            commentsDiv.appendChild(commentItem);
                            
                        });
                    }
                    const paginationDiv = document.createElement('div');
                    paginationDiv.className = 'pagination';
                    for (let i = 1; i <= data.total_pages; i++) {
                        paginationDiv.innerHTML += `
                            <button onclick="loadComments('${projectName}', ${i})" ${
                                i === data.page ? 'class="active"' : ''
                            }>${i}</button>
                        `;
                    }
                    commentsDiv.appendChild(paginationDiv);
                })
                .catch(error => console.error('Error fetching comments:', error));
        }

        function editComment(projectName, commentId) {
            const newRating = prompt('Enter new rating (1-5):');
            const newText = prompt('Enter new comment text:');

            if (newRating && newText) {
                const apiUrlUpdate = `/api/comments/${encodeURIComponent(projectName)}/update/${commentId}/`;

                fetch(apiUrlUpdate, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': csrfToken,
                    },
                    body: JSON.stringify({
                        rating: newRating,
                        text: newText,
                    }),
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.message) {
                            console.log(`Comment updated: ${data.message}`);
                            loadComments(projectName);
                        } else if (data.error) {
                            console.error('Error updating comment:', data.error);
                        }
                    })
                    .catch(error => console.error('Error updating comment:', error));
            }
        }

        function deleteComment(projectName, commentId) {
            if (confirm('Are you sure you want to delete this comment?')) {
                const apiUrlDelete = `/api/comments/${encodeURIComponent(projectName)}/delete/${commentId}/`;

                fetch(apiUrlDelete, {
                    method: 'DELETE',
                    headers: {
                        'X-CSRFToken': csrfToken,
                    },
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.message) {
                            console.log(`Comment deleted: ${data.message}`);
                            loadComments(projectName);
                        } else if (data.error) {
                            console.error('Error deleting comment:', data.error);
                        }
                    })
                    .catch(error => console.error('Error deleting comment:', error));
            }
        }


        const csrfToken = '{{ csrf_token }}';
        function loadMarkdown(projectName) {
            const contentDiv = document.getElementById('content');
            const apiUrlMarkdown = `/api/personal_experience/${encodeURIComponent(projectName)}/`;
            const apiUrlComments = `/api/comments/${encodeURIComponent(projectName)}/`;
            const apiUrlUserStatus = '/api/user_status/';

            // 加载 Markdown 文件内容
            fetch(apiUrlMarkdown)
                .then(response => response.text())
                .then(markdown => {
                    contentDiv.innerHTML = marked.parse(markdown);
                    fetch(apiUrlUserStatus)
                        .then(response => response.json())
                        .then(userStatus => {
                            const isAuthenticated = userStatus.is_authenticated;
                            contentDiv.innerHTML += `
                                <div id="comments-section">
                                    <h2>Comments & Ratings</h2>
                                    <div id="comments-list">
                                        <h3>All Comments</h3>
                                        <!-- 评论列表将动态加载 -->
                                    </div>
                                    ${isAuthenticated ? `
                                        <div id="rating">
                                            <label for="rating">Rate this project:</label>
                                            <select id="ratingValue">
                                                <option value="5">5 - Excellent</option>
                                                <option value="4">4 - Very Good</option>
                                                <option value="3">3 - Good</option>
                                                <option value="2">2 - Fair</option>
                                                <option value="1">1 - Poor</option>
                                            </select>
                                        </div>
                                        <div id="add-comment">
                                            <label for="comment">Add a Comment:</label>
                                            <textarea id="commentText" rows="4" cols="50"></textarea>
                                            <button onclick="submitComment('${projectName}')">Submit</button>
                                        </div>
                                    ` : `
                                        <p>Please <a href="/login/">log in</a> to leave a comment.</p>
                                    `}
                                </div>
                            `;

                            // 加载评论列表
                            loadComments(projectName);
                        })
                        .catch(error => console.error('Error checking user status:', error));
                    })
                    .catch(error => console.error('Error fetching markdown:', error));

                }


        function submitComment(projectName) {
            const rating = document.getElementById('ratingValue').value;
            const commentText = document.getElementById('commentText').value;
            const apiUrlSubmit = `/api/comments/${encodeURIComponent(projectName)}/submit/`;
            console.log('Submitting comment:', {
                rating: rating,
                text: commentText,
            });

            fetch(apiUrlSubmit, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': csrfToken // 添加 CSRF token
                },
                body: JSON.stringify({
                    rating: rating,
                    text: commentText,
                }),
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Error submitting comment.');
                    }
                    console.log('Response status:', response.status);
                    return response.json();
                })
                .then(data => {
                    // 清空输入框
                    console.log('Response Data:', data); 
                    if (data.message) {
                        console.log(`Comment submitted: ${data.message}`);
                        // 清空输入框
                        document.getElementById('commentText').value = '';
                        // 刷新评论列表
                        loadComments(projectName);
                    } else {
                        console.error('Unexpected response:', data);
                    }                
                })
                .catch(error => console.error('Error submitting comment:', error));
        }

        // function loadContent(type) {
        //     let apiUrl = `/api/${type}/`;
        //     console.log(`Requesting data from: ${apiUrl}`);

        //     fetch(apiUrl)
        //         .then(response => {
        //         console.log(`Response status: ${response.status}`); // 调试信息
        //         if (!response.ok) {
        //             throw new Error(`HTTP error! status: ${response.status}`);
        //             }
        //             return response.json();
        //         })
        //         .then(data => {
        //             const contentDiv = document.getElementById('content');
        //             contentDiv.innerHTML = ''; // 清空内容区域
                    // if (type === 'home' || type === 'personal_detail') {
                    //     contentDiv.innerHTML = marked.parse(data.markdown);
                    //     } else if (type === 'skills') {
                    //         contentDiv.innerHTML = '<h1>Skills</h1>';
                    //         data.skills.forEach(skill => {
                    //         contentDiv.innerHTML += `
                    //             <p style="font-size: 1.2em; color: #333; margin-bottom: 10px;">
                    //                 <strong>${skill}</strong>
                    //             </p>
                    //             `;
                    //         });
        //             } else if (type === 'personal_experience') {
        //                 data.projects.forEach(project => {
        //                     contentDiv.innerHTML += `
        //                         <div class="experience-item">
        //                             <h2><a href="/experience/${encodeURIComponent(project.name)}/">${project.name}</a></h2>
        //                             <p>${project.description}</p>
        //                         </div>
        //                     `;
        //                 });
        //                 contentDiv.innerHTML += '<div id="pagination" class="pagination"></div>';
        //                 const paginationDiv = document.getElementById('pagination');
        //                 if (data.previous_page) {
        //                     paginationDiv.innerHTML += `<button onclick="loadPage(${data.previous_page})">Previous</button>`;
        //                 }
        //                 data.page_range.forEach(page => {
        //                     paginationDiv.innerHTML += `<button onclick="loadPage(${page})">${page}</button>`;
        //                 });
        //                 if (data.next_page) {
        //                     paginationDiv.innerHTML += `<button onclick="loadPage(${data.next_page})">Next</button>`;
        //                 } 
                    // } else if (type === 'contact') {
                    //     contentDiv.innerHTML = '<h1>Contact Me</h1>';
                    //     contentDiv.innerHTML += `
                    //         <p style="font-size: 1.2em; font-weight: bold;">
                    //             Phone: <a href="tel:${data.phone}" style="color: blue; text-decoration: underline;">
                    //                 ${data.phone}
                    //             </a>
                    //         </p>
                    //     `;
                    //     contentDiv.innerHTML += `
                    //         <p style="font-size: 1.2em; font-weight: bold;">
                    //             Email: <a href="mailto:${data.email}" style="color: blue; text-decoration: underline;">
                    //                 ${data.email}
                    //             </a>
                    //         </p>
                    //     `;

                    // }
        //         })
        //     }
        // function loadPage(page) {
        //     fetch(`/api/personal_experience/?page=${page}`)
        //         .then(response => response.json())
        //         .then(data => {
        //             const contentDiv = document.getElementById('content');
        //             contentDiv.innerHTML = '';
        //             data.projects.forEach(project => {
        //                 contentDiv.innerHTML += `
        //                     <div class="experience-item">
        //                         <h2><a href="/experience/${project.name}/">${project.name}</a></h2>
        //                         <p>${project.description}</p>
        //                     </div>
        //                 `;
        //             });

        //             const paginationDiv = document.getElementById('pagination');
        //             paginationDiv.innerHTML = '';
        //             if (data.previous_page) {
        //                 paginationDiv.innerHTML += `<button onclick="loadPage(${data.previous_page})">Previous</button>`;
        //             }
        //             data.page_range.forEach(page => {
        //                 paginationDiv.innerHTML += `<button onclick="loadPage(${page})">${page}</button>`;
        //             });
        //             if (data.next_page) {
        //                 paginationDiv.innerHTML += `<button onclick="loadPage(${data.next_page})">Next</button>`;
        //             }
        //         })
        //         .catch(error => console.error('Error:', error));
        // }
        function toggleSubMenu() {
            const submenu = document.getElementById('submenu');
            submenu.style.display = submenu.style.display === 'block' ? 'none' : 'block';
        }

        document.addEventListener("DOMContentLoaded", function () {
            const slider = document.getElementById("imageSlider");
            const images = slider.querySelectorAll("img");
            let currentIndex = 0;
            let interval = null;

            // 初始化按钮容器
            const buttonContainer = document.createElement("div");
            buttonContainer.classList.add("slider-buttons");
            slider.appendChild(buttonContainer);

            // 为每张图片生成一个按钮
            images.forEach((_, index) => {
                const button = document.createElement("button");
                if (index === 0) button.classList.add("active");
                button.addEventListener("click", () => {
                    switchImage(index);
                    resetTimer();
                });
                buttonContainer.appendChild(button);
            });

            const buttons = buttonContainer.querySelectorAll("button");

            // 切换图片函数
            function switchImage(nextIndex) {
                images[currentIndex].classList.remove("active");
                buttons[currentIndex].classList.remove("active");

                images[nextIndex].classList.add("active");
                buttons[nextIndex].classList.add("active");

                currentIndex = nextIndex;
            }
            function autoSwitch(){
                const nextIndex = (currentIndex +1) %images.length;
                switchImage(nextIndex);
            }
            function resetTimer(){
                clearInterval(interval);
                interval = setInterval(autoSwitch,5000);
            }
            resetTimer();




            // 切换图片函数
            function switchImage(nextIndex) {
                images[currentIndex].classList.remove("active");
                buttons[currentIndex].classList.remove("active");

                images[nextIndex].classList.add("active");
                buttons[nextIndex].classList.add("active");

                currentIndex = nextIndex;
            }

            // 图片点击事件，切换到下一张
            slider.addEventListener("click", function () {
                const nextIndex = (currentIndex + 1) % images.length;
                switchImage(nextIndex);
            });
        });



        document.addEventListener("scroll", function () {
            const sidebar = document.querySelector(".sidebar");
            const scrollPosition = window.scrollY;

            // 根据滚动位置动态改变背景颜色
            const baseColor = 244; // RGB 基础颜色值
            const adjustedColor = Math.max(200, baseColor - scrollPosition / 10); // 最低值限制为 200
            sidebar.style.background = `rgb(${adjustedColor}, ${adjustedColor}, ${adjustedColor})`;
        });


        document.addEventListener("DOMContentLoaded", function () {
            const sidebar = document.getElementById("sidebar");
            const toggleButton = document.getElementById("toggleButton");

            // 更新按钮位置函数
            function updateButtonPosition() {
                const sidebarWidth = sidebar.offsetWidth; // 获取侧边栏宽度
                const sidebarLeft = sidebar.getBoundingClientRect().left; // 获取侧边栏的左侧位置
                const sidebarRight = sidebarLeft + sidebarWidth; // 计算侧边栏的右边界位置
                toggleButton.style.left = `${sidebarRight}px`; // 动态设置按钮位置
            }

            // 初次加载时设置按钮位置
            updateButtonPosition();

            // 点击按钮切换侧边栏状态
            toggleButton.addEventListener("click", function () {
                if (sidebar.classList.contains("collapsed")) {
                    // 展开侧边栏
                    sidebar.classList.remove("collapsed");
                    toggleButton.textContent = "";
                } else {
                    // 收起侧边栏
                    sidebar.classList.add("collapsed");
                    toggleButton.textContent = "";
                }
            });

            // 当侧边栏动画完成时更新按钮位置
            sidebar.addEventListener("transitionend", updateButtonPosition);

            // 窗口大小变化时重新调整按钮位置
            window.addEventListener("resize", updateButtonPosition);
        });
        function getRandomColorFromPreset() {
            const colors = [
                { backgroundColor: "#f0f8ff", borderColor: "#4682b4" }, // 浅蓝色 + 深蓝色
                // { backgroundColor: "#ffe4e1", borderColor: "#cd5c5c" }, // 淡粉色 + 红棕色
                // { backgroundColor: "#fafad2", borderColor: "#bdb76b" }, // 浅黄色 + 暗卡其色
                // { backgroundColor: "#d3d3d3", borderColor: "#a9a9a9" }, // 浅灰色 + 暗灰色
            ];
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function applyPresetColorsToExtraSection() {
            // const extraSection = document.querySelector('.extra-section');
            const commentitem = document.querySelector('.comment-item');
            if (extraSection) {
                const { backgroundColor, borderColor } = getRandomColorFromPreset();
                extraSection.style.backgroundColor = backgroundColor;
                extraSection.style.borderColor = borderColor;
            } 
            else if (commentitem) {
                const { backgroundColor, borderColor } = getRandomColorFromPreset();
                commentitem.style.backgroundColor = backgroundColor;
                commentitem.style.borderColor = borderColor;
            }
        }

        document.addEventListener("DOMContentLoaded", function () {
            const editButton = document.getElementById("editContactButton");
            if (editButton) {
                editButton.addEventListener("click", function () {
                    enableEditMode({
                        phone1: "02108500920",
                        phone2: "13647482621",
                        email: "mikuohatsune0712@gmail.com",
                    });
                });
            }
        });
        // 在页面加载时调用
        // document.addEventListener("DOMContentLoaded", function () {
        //     applyPresetColorsToExtraSection();
        // });

        function enableEditMode(contactData) {
            let contactInfo = document.getElementById('contactInfo');
            if (!contactInfo) {
                contactInfo = document.createElement('div');
                contactInfo.id = 'contactInfo';
                document.getElementById('content').appendChild(contactInfo);
            }

            contactInfo.innerHTML = `
                <h2>Edit Contact Information</h2>
                <form id="editContactForm">
                    {% csrf_token %}
                    <label for="phone1Input">Phone 1:</label>
                    <input type="text" id="phone1Input" name="phone1" value="${contactData.phone1}" required><br/>

                    <label for="phone2Input">Phone 2:</label>
                    <input type="text" id="phone2Input" name="phone2" value="${contactData.phone2}" required><br/>

                    <label for="emailInput">Email:</label>
                    <input type="email" id="emailInput" name="email" value="${contactData.email}" required><br/>

                    <button type="submit" class="save-button">Save</button>
                    <button type="button" class="cancel-button">Cancel</button>
                </form>
            `;

            // 绑定事件
            const form = document.getElementById('editContactForm');
            form.addEventListener('submit', function (e) {
                e.preventDefault();
                saveUpdatedContact();
            });

            const cancelButton = document.querySelector('.cancel-button');
            cancelButton.addEventListener('click', function () {
                loadContent('contact'); // 返回原来的界面
            });
        }

        function saveUpdatedContact() {
            const updatedContact = {
                phone1: document.getElementById('phone1Input').value,
                phone2: document.getElementById('phone2Input').value,
                email: document.getElementById('emailInput').value,
            };

            fetch('/api/update_contact/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-CSRFToken': getCSRFToken(),
                },
                body: JSON.stringify(updatedContact),
            })
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Failed to update contact information.');
                    }
                    return response.json();
                })
                .then(data => {
                    alert('Contact information updated successfully!');
                    loadContent('contact'); // 刷新页面内容
                })
                .catch(error => console.error('Error updating contact information:', error));
        }

        // 获取 CSRF Token
        function getCSRFToken() {
            return document.querySelector('[name=csrfmiddlewaretoken]').value;
        }

        document.addEventListener("DOMContentLoaded", function () {
        const image = document.getElementById('media-image');
        if (image) {
            image.addEventListener('dblclick', function () {
                if (image.classList.contains('zoomed')) {
                    image.classList.remove('zoomed');
                } else {
                    image.classList.add('zoomed');
                }
            });
        }
    });


    </script>
</body>
</html>